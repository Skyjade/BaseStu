<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>org</title>
		<link href="../../css/all.css" rel="stylesheet">
		<script src="../../js/allSecond.js"></script>
		<style>
			.input-with-select .el-input-group__prepend {
				background-color: #fff;
			}
			
			.leftBox {
				position: absolute;
				left: 0;
				width: 260px;
				top: 0px;
				bottom: 0;
			}
			
			.rightBox {
				position: absolute;
				left: 275px;
				right: 0;
			}
			
			.el-tree-node__content {
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				height: 36px;
				cursor: pointer;
			}
			
			.el-tree-node__label {
				font-size: 14px;
				color: #666666;
			}
			
			.el-dialog .el-tree {
				position: relative;
				cursor: default;
				background: #fff;
				color: #606266;
				height: 260px;
				overflow: auto;
			}
		</style>
	</head>

	<body class="gray-bg">
		<div id="org" style="position: relative; width: 100%; height: 100%;">
			<div class="leftBox content_bg tree" style="overflow: auto;">
				<div class="mg_b10 mg_t10">
					<el-select size="mini" v-model="searchAppID" style="width: 200px;margin-right: 10px;" @change="selectAppID()">
						<el-option v-for="list in operateApp" :label="list.name" :value="list.id">
						</el-option>
					</el-select>
					<i class="fa fa-trash-o el-icon-refresh t_right clearTree" @click="clearTree()"></i>
				</div>
				<el-tree ref="tree" :props="defaultProps" node-key="id" :default-expanded-keys="[0]" :load="loadNode" :highlight-current="highlight" lazy accordion @node-click="handleNodeClick"></el-tree>
			</div>
			<div class="rightBox">
				<div class="content_bg" style="height: 60px;">
					<div class="t_left">
						<el-select style="width:150px;height: 32px;" size="small" v-model="chooseState" slot="prepend" data-i18n="[placeholder]common.select" @change="selectState()">
							<el-option v-for="list in stateOptions" :label="list.text" :value="list.code">
							</el-option>
						</el-select>
					</div>
					<div class="t_left mg_l10">
						<el-input data-i18n="[placeholder]common.inputName" v-model.trim="searchNameNo" size="small" style="width:300px;height: 32px;" @keyup.enter.native="searchOrg" clearable></el-input>
					</div>
					<div class="t_right mg_l15">
						<el-button size="small" type="primary" icon="el-icon-search" @click="searchOrg()"><span data-i18n="common.search"></span></el-button>
					</div>
					<div class="clear"></div>
				</div>
				<div class="content_bg mg_t14">
					<div class="tableTitle">
						<div class="font16 f_color1 t_left" style="height: 30px;line-height: 30px;">
							<span data-i18n="common.orgTitle"></span>
						</div>
						<div class="t_right">
							<el-button round size="small" icon="el-icon-document" v-on:click="openNewDialog" :disabled="addDisabled"><span data-i18n="common.add"></span></el-button>
						</div>
						<div class="clear"></div>
					</div>
					<el-table border stripe :data="orgListData" style="width: 100%;">
						<el-table-column prop="no" :label="$.t('org.no')" min-width="150" show-overflow-tooltip></el-table-column>
						<el-table-column prop="name" :label="$.t('common.name')" min-width="150" show-overflow-tooltip></el-table-column>
						<el-table-column prop="code" :label="$.t('role.code')" width="150" show-overflow-tooltip></el-table-column>
						<el-table-column prop="typeName" :label="$.t('common.type')" width="120" show-overflow-tooltip></el-table-column>
						<el-table-column :label="$.t('common.whetherToEnable')" width="120" show-overflow-tooltip>
							<template slot-scope="scope">
								<el-switch v-model="scope.row.stateNo" :disabled="stateDisabled" @change="stateChange(scope.row)">
								</el-switch>
							</template>
						</el-table-column>
						<el-table-column prop="up_time" :label="$.t('role.updateTime')" width="180" show-overflow-tooltip></el-table-column>
						<el-table-column :label="$.t('common.operate')" min-width="150">
							<template slot-scope="scope">
								<el-tooltip class="item" effect="dark" :content="$.t('common.edit')" placement="top">
									<el-button size="mini" icon="el-icon-edit" :disabled="editDisabled" @click="openEditDialog(scope.$index, scope.row)" circle></el-button>
								</el-tooltip>
								<el-tooltip class="item" effect="dark" :content="$.t('common.up')" placement="top">
									<el-button size="mini" icon="el-icon-upload2" @click="rankMove(scope.$index, scope.row,1)" :disabled="orderDisabled" circle></el-button>
								</el-tooltip>
								<el-tooltip class="item" effect="dark" :content="$.t('common.down')" placement="top">
									<el-button size="mini" icon="el-icon-download" @click="rankMove(scope.$index, scope.row,0)" :disabled="orderDisabled" circle></el-button>
								</el-tooltip>
							</template>
						</el-table-column>
					</el-table>
					<div class="block mg_t20" style="background: white;width:100%;height:40px;">
						<el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange" background :current-page="currentPage" :page-sizes="[10, 20, 30]" :page-size="page_size" layout="total, sizes, prev, pager, next, jumper" :total="total_count">
						</el-pagination>
					</div>
				</div>
			</div>

			<!--新增业务组织-->
			<el-dialog :title=" $.t('common.add')" :visible.sync="addOrg" width="650px" :close-on-click-modal="false">
				<el-form :model="addOrgData" :inline="true" :rules="rules" size="small" ref="addOrgForm" label-width="88px" class="demo-ruleForm">
					<el-form-item :label="$.t('org.parentOrg')">
						<el-input v-model="addOrgData.parentName" style="width: 200px;" disabled></el-input>
					</el-form-item>
					<el-form-item :label="$.t('role.code')" prop="code">
						<el-input v-model="addOrgData.code" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.name')" prop="name">
						<el-input v-model.trim="addOrgData.name" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.type')">
						<el-select size="small" v-model="addOrgData.type" style="width: 200px;" data-i18n="[placeholder]common.select">
							<el-option v-for="list in typeOptions" :label="list.text" :value="list.code">
							</el-option>
						</el-select>
					</el-form-item>
					<el-form-item :label="$.t('common.app')" prop="app_id">
						<el-select size="small" v-model="addOrgData.app_id" disabled style="width: 200px;">
							<el-option v-for="list in operateApp" :label="list.name" :value="list.id">
							</el-option>
						</el-select>
					</el-form-item>
					<el-form-item :label="$.t('org.timeZone')" prop="timeZone">
						<el-select size="small" v-model="addOrgData.time_zone" style="width: 200px;" data-i18n="[placeholder]common.select">
							<el-option v-for="list in timeZoneOptions" :label="list.text" :value="list.code">
							</el-option>
						</el-select>
					</el-form-item>
				</el-form>
				<div slot="footer" class="dialog-footer">
					<el-button type="primary" @click="newConfirm" data-i18n="common.confirm"></el-button>
					<el-button @click="addOrg = false" data-i18n="common.cancel"></el-button>
				</div>
			</el-dialog>
			<!--编辑业务组织-->
			<el-dialog :title=" $.t('common.edit')" :visible.sync="editOrg" width="350px" :close-on-click-modal="false">
				<el-form :model="editOrgData" :inline="true" :rules="rules" size="small" ref="editOrgForm" label-width="88px" class="demo-ruleForm">
					<el-form-item :label="$.t('common.app')" prop="app_id">
						<el-select size="small" v-model="editOrgData.app_id" disabled style="width: 200px;">
							<el-option v-for="list in operateApp" :label="list.name" :value="list.id">
							</el-option>
						</el-select>
					</el-form-item>
					<el-form-item :label="$.t('role.code')" prop="code">
						<el-input v-model="editOrgData.code" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.name')" prop="name">
						<el-input v-model.trim="editOrgData.name" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.type')">
						<el-select size="small" v-model="addOrgData.type" style="width: 200px;" data-i18n="[placeholder]common.select">
							<el-option v-for="list in typeOptions" :label="list.text" :value="list.code">
							</el-option>
						</el-select>
					</el-form-item>
					<el-form-item :label="$.t('org.timeZone')" prop="timeZone">
						<el-select size="small" v-model="editOrgData.time_zone" style="width: 200px;" data-i18n="[placeholder]common.select">
							<el-option v-for="list in timeZoneOptions" :label="list.text" :value="list.code">
							</el-option>
						</el-select>
					</el-form-item>
				</el-form>
				<div slot="footer" class="dialog-footer">
					<el-button type="primary" @click="editConfirm" data-i18n="common.confirm"></el-button>
					<el-button @click="editOrg = false" data-i18n="common.cancel"></el-button>
				</div>
			</el-dialog>

		</div>

		<script type="text/javascript" src="../../js/manage/org.js"></script>
	</body>

</html>