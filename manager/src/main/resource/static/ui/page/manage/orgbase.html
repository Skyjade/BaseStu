<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link href="../../css/all.css" rel="stylesheet">
		<script src="../../js/allSecond.js"></script>
		<style>
			.input-with-select .el-input-group__prepend {
				background-color: #fff;
			}
			
			.leftBox {
				position: absolute;
				left: 0;
				width: 230px;
				top: 0px;
				bottom: 0;
			}
			
			.rightBox {
				position: absolute;
				left: 245px;
				right: 0;
			}
			
			.el-tree-node__content {
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				height: 36px;
				cursor: pointer;
			}
			
			.el-tree-node__label {
				font-size: 14px;
				color: #666666;
			}
		</style>
	</head>

	<body style="overflow-y: hidden">
		<div id="baseOrgManage" style="position: relative; width: 100%; height: 100%;">
			<div class="leftBox content_bg tree" style="overflow-y: auto;">
				<div>
					<div class="font16 f_color1 t_left" style="height: 30px;line-height: 30px;"><span data-i18n="org.baseOrg" /></div>
					<i class="fa fa-trash-o el-icon-refresh t_right clearTree" @click="clearTree()"></i>
					<div class="clear"></div>
				</div>
				<el-tree ref="baseOrgTree" node-key="id" :highlight-current="highlight" :load="loadLeftTreeNode" lazy accordion :props="defaultProps" @node-click="handleLeftTreeNodeClick"></el-tree>
			</div>
			<div class="rightBox">
				<div class="content_bg" style="height: 62px;">
					<div class="t_left">
						<el-select size="small" style="width: 150px;height: 32px;" v-model="stateValue" slot="prepend" data-i18n="[placeholder]common.select" @change="selectState()">
							<el-option v-for="list in stateSel" :label="list.text" :value="list.code"></el-option>
						</el-select>
					</div>
					<div class="t_left mg_l10">
						<el-input style="width: 300px;height: 32px;" v-model.trim="searchInput" size="small" clearable data-i18n="[placeholder]common.inputName" @keyup.enter.native="searchBaseOrg()"></el-input>
					</div>
					<div class="t_right mg_l15">
						<el-button size="small" type="primary" icon="el-icon-search" @click="searchBaseOrg()"><span data-i18n="common.search"></span></el-button>
					</div>
					<div class="clear"></div>
				</div>
				<div class="content_bg mg_t14">
					<div class="tableTitle">
						<div class="font16 f_color1 t_left" style="height: 30px;line-height: 30px;">
							<span data-i18n="common.baseOrgTitle"></span>
						</div>
						<div class="t_right">
							<el-button round size="small" icon="el-icon-document" @click="openAddBaseOrgDialog()" :disabled="addDisabled"><span data-i18n="common.add"></span></el-button>
						</div>
						<div class="clear"></div>
					</div>
					<el-table ref="baseOrgListData" border stripe :data="baseOrgListData" tooltip-effect="dark" style="width: 100%;" @selection-change="handleSelectionChange">
						<!--<el-table-column type="selection" width="55" align="center">
						</el-table-column>-->
						<el-table-column prop="name" :label="$.t('common.name')" min-width="180" show-overflow-tooltip>
						</el-table-column>
						<el-table-column prop="code" :label="$.t('role.code')" width="150" show-overflow-tooltip>
						</el-table-column>
						<el-table-column :label="$.t('common.whetherToEnable')" width="120" show-overflow-tooltip>
							<template slot-scope="scope">
								<el-switch v-model="scope.row.stateNo" :disabled="stateDisabled" @change="stateChange(scope.row)">
								</el-switch>
							</template>
						</el-table-column>
						<el-table-column :label="$.t('common.operate')" min-width="150">
						      <template slot-scope="scope">
						      	<el-tooltip class="item" effect="dark" :content="$.t('common.delete')" placement="top">
										<el-button size="mini" type="danger" icon="el-icon-delete" :disabled="deleteDisabled" @click="deleteBaseOrg(scope.row)" circle></el-button>
									</el-tooltip>
						      	<el-tooltip class="item" effect="dark" :content="$.t('common.edit')" placement="top">
						      		<el-button size="mini" icon="el-icon-edit" :disabled="editDisabled" @click="openEditBaseOrgDialog(scope.$index, scope.row)" circle></el-button>
							    </el-tooltip>
							    <el-tooltip class="item" effect="dark" :content="$.t('common.up')" placement="top">
							    	<el-button size="mini" icon="el-icon-upload2" @click="rankMove(scope.$index, scope.row,1)" :disabled="orderDisabled" circle></el-button>
							    </el-tooltip>
							    <el-tooltip class="item" effect="dark" :content="$.t('common.down')" placement="top">
							    	<el-button size="mini" icon="el-icon-download" @click="rankMove(scope.$index, scope.row,0)" :disabled="orderDisabled" circle></el-button>
							    </el-tooltip>
						      </template>
					    </el-table-column>	
					</el-table>
					<div class="block mg_t20" style="background: white;width:100%;height:40px;">
						<el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="currentPage" :total="total" background :page-size="pageSize" :page-sizes="[10, 20, 30]" layout="total,sizes, prev, pager, next,jumper">
						</el-pagination>
					</div>
				</div>
			</div>
			<!--新增基准组织弹框-->
			<el-dialog :title="$.t('common.add')" :visible.sync="addBaseOrgDialog" width="370px" :close-on-click-modal="false">
				<el-form :model="addBaseOrgData" size="small" :rules="rules" ref="addBaseOrgForm" label-width="120px" class="demo-ruleForm">
					<el-form-item :label="$.t('baseOrg.parentBaseOrg')">
						<el-input v-model="selBaseOrgNode.name" disabled style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('role.code')" prop="code">
						<el-input v-model="addBaseOrgData.code" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.name')" prop="name">
						<el-input v-model.trim="addBaseOrgData.name" style="width: 200px;"></el-input>
					</el-form-item>
					<!--<el-form-item :label="i18n.status" prop="state" style="width:100%" :rules="[
                                { required: true, message: '状态不能为空'}
                     ]">
						<el-select v-model="addBaseOrgData.state" placeholder="请选择" style="width:100%">
							<el-option label="启用" value="1"></el-option>
							<el-option label="停用" value="0"></el-option>
						</el-select>
					</el-form-item>-->
				</el-form>
				<span slot="footer" class="dialog-footer">             
               <el-button type="primary" @click="addBaseOrg()" data-i18n="common.confirm"></el-button>
               <el-button @click="addBaseOrgDialog = false" data-i18n="common.cancel"></el-button>
               </span>
			</el-dialog>
			<!--编辑基准组织弹框-->
			<el-dialog :title="$.t('common.edit')" :visible.sync="editBaseOrgDialog" width="300px" :close-on-click-modal="false">
				<el-form :model="editBaseOrgData" size="mini" :rules="rules" ref="editBaseOrgForm" label-width="62px" class="demo-ruleForm">
					<el-form-item :label="$.t('role.code')" prop="code">
						<el-input v-model="editBaseOrgData.code" style="width: 200px;"></el-input>
					</el-form-item>
					<el-form-item :label="$.t('common.name')" prop="name">
						<el-input v-model.trim="editBaseOrgData.name" style="width: 200px;"></el-input>
					</el-form-item>
				</el-form>

				<span slot="footer" class="dialog-footer">
				<el-button type="primary" @click="editBaseOrg()" data-i18n="common.confirm"></el-button>
               <el-button @click="editBaseOrgDialog = false" data-i18n="common.cancel"></el-button>              
               </span>
			</el-dialog>
		</div>

		<script src="../../js/manage/orgbase.js"></script>
	</body>

</html>